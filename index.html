<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Пример CloudStorage с очками</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        Telegram.WebApp.init();

        // Функция для сохранения очков в CloudStorage
        function savePoints(points) {
            // Получаем текущее значение очков
            Telegram.WebApp.CloudStorage.getItem('points', function(error, value) {
                if (error) {
                    console.error('Ошибка получения очков:', error);
                    return;
                }

                // Преобразуем текущее значение очков в число
                let currentPoints = parseInt(value) || 0;

                // Добавляем новые очки
                currentPoints += points;

                // Сохраняем обновленное значение очков
                Telegram.WebApp.CloudStorage.setItem('points', currentPoints.toString(), function(error, success) {
                    if (error) {
                        console.error('Ошибка сохранения очков:', error);
                    } else {
                        console.log('Очки успешно сохранены:', currentPoints);
                        document.getElementById('pointsDisplay').innerText = 'Ваши очки: ' + currentPoints;
                    }
                });
            });
        }

        // Функция для отображения текущих очков
        function displayPoints() {
            Telegram.WebApp.CloudStorage.getItem('points', function(error, value) {
                if (error) {
                    console.error('Ошибка получения очков:', error);
                } else {
                    const currentPoints = parseInt(value) || 0;
                    document.getElementById('pointsDisplay').innerText = 'Ваши очки: ' + currentPoints;
                }
            });
        }

        // Отображаем очки при загрузке страницы
        window.onload = displayPoints;

    </script>
</head>
<body>
    <h1>Пример работы с CloudStorage</h1>
    <p id="pointsDisplay">Ваши очки: 0</p>
    <button onclick="savePoints(25)">Добавить 25 очков</button>
</body>
</html>
